unit ini;

interface

uses
  System.SysUtils, System.IniFiles, Vcl.Dialogs;  // 👈 Se agregó Vcl.Dialogs por si se quiere mostrar un mensaje

procedure LeerDatosConexion(var Servidor, BaseDatos, Usuario, Clave: string; var Puerto: Integer);
procedure GuardarDatosConexion(Servidor, BaseDatos, Usuario, Clave: string; Puerto: Integer);

implementation

// Lee los datos del archivo INI
procedure LeerDatosConexion(var Servidor, BaseDatos, Usuario, Clave: string; var Puerto: Integer);
var
  Ini: TIniFile;
  Ruta: string;
begin
  Ruta := ExtractFilePath(ParamStr(0)) + 'gevensoft.ini';

  if not FileExists(Ruta) then
  begin
    ShowMessage('No se encontró el archivo gevensoft.ini');
    Exit;
  end;

  Ini := TIniFile.Create(Ruta);
  try
    Servidor  := Ini.ReadString('BD_BASE', 'host', 'localhost');
    BaseDatos := Ini.ReadString('BD_BASE', 'database', 'gevensoftbase');
    Usuario   := Ini.ReadString('BD_BASE', 'user', 'postgres');
    Clave     := Ini.ReadString('BD_BASE', 'password', '');
    Puerto    := Ini.ReadInteger('BD_BASE', 'port', 5432);
  finally
    Ini.Free;
  end;
end;

// Guarda los datos en el archivo INI
procedure GuardarDatosConexion(Servidor, BaseDatos, Usuario, Clave: string; Puerto: Integer);
var
  Ini: TIniFile;
  Ruta: string;
begin
  Ruta := ExtractFilePath(ParamStr(0)) + 'gevensoft.ini';

  Ini := TIniFile.Create(Ruta);
  try
    Ini.WriteString('BD_BASE', 'host', Servidor);
    Ini.WriteString('BD_BASE', 'database', BaseDatos);
    Ini.WriteString('BD_BASE', 'user', Usuario);
    Ini.WriteString('BD_BASE', 'password', Clave);
    Ini.WriteInteger('BD_BASE', 'port', Puerto);
  finally
    Ini.Free;
  end;

  ShowMessage('Datos guardados correctamente.');
end;

end.

