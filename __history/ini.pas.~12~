unit ini;

interface

uses
  System.SysUtils, System.IniFiles, Vcl.Dialogs;  // 👈 Se agregó Vcl.Dialogs por si se quiere mostrar un mensaje

procedure LeerDatosConexion(var Servidor, BaseDatos, Usuario, Clave: string; var Puerto: Integer);
procedure GuardarDatosConexion(Servidor, BaseDatos, Usuario, Clave: string; Puerto: Integer);

implementation

// Lee los datos del archivo INI
procedure LeerDatosConexion(var Servidor, BaseDatos, Usuario, Clave: string; var Puerto: Integer);
var
  Ini: TIniFile;
  Ruta: string;
begin
  Ruta := ExtractFilePath(ParamStr(0)) + 'Gevensoft.ini';
  if not FileExists(Ruta) then
  begin
    ShowMessage('No se encontró el archivo Gevensoft.ini');
    Exit;
  end;

  Ini := TIniFile.Create(Ruta);
  try
    Servidor  := Ini.ReadString('DATABASE', 'Server', 'localhost');
    BaseDatos := Ini.ReadString('DATABASE', 'Database', 'bdgevensoftbase');
    Usuario   := Ini.ReadString('DATABASE', 'User', 'postgres');
    Clave     := Ini.ReadString('DATABASE', 'Password', '');  // 👈 coincide con tu INI
    Puerto    := Ini.ReadInteger('DATABASE', 'Port', 5432);
  finally
    Ini.Free;
  end;
end;


// Guarda los datos en el archivo INI
procedure GuardarDatosConexion(Servidor, BaseDatos, Usuario, Clave: string; Puerto: Integer);
var
  Ini: TIniFile;
  Ruta: string;
begin
  Ruta := ExtractFilePath(ParamStr(0)) + 'gevensoft.ini';

  Ini := TIniFile.Create(Ruta);
  try
    Ini.WriteString('BD_BASE', 'Server', Servidor);
    Ini.WriteString('BD_BASE', 'Database', BaseDatos);
    Ini.WriteString('BD_BASE', 'User', Usuario);
    Ini.WriteString('BD_BASE', 'Password', Clave);
    Ini.WriteInteger('BD_BASE', 'Port', Puerto);
  finally
    Ini.Free;
  end;

  ShowMessage('Datos guardados correctamente.');
end;

end.

